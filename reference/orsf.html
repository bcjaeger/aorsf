<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Oblique Random Survival Forest (ORSF) — orsf • aorsf</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Oblique Random Survival Forest (ORSF) — orsf"><meta property="og:description" content="The oblique random survival forest (RSF) is an extension of the RSF
algorithm developed by Ishwaran et al and maintained in the
RandomForestSRC package. The only difference between oblique
RSF and Ishwaran's RSF is that oblique RSFs use linear combinations
of input variables instead of using the input variable as-is when
growing new nodes in survival decision trees. For more details on
the oblique RSF, see Jaeger et al, 2019."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">aorsf</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.0.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/getting_started.html">Getting started</a>
    </li>
  </ul></li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/bcjaeger/aorsf/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Oblique Random Survival Forest (ORSF)</h1>
    <small class="dont-index">Source: <a href="https://github.com/bcjaeger/aorsf/blob/HEAD/R/orsf_fit.R" class="external-link"><code>R/orsf_fit.R</code></a></small>
    <div class="hidden name"><code>orsf.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>The oblique random survival forest (RSF) is an extension of the RSF
algorithm developed by Ishwaran et al and maintained in the
<code>RandomForestSRC</code> package. The only difference between oblique
RSF and Ishwaran's RSF is that oblique RSFs use linear combinations
of input variables instead of using the input variable as-is when
growing new nodes in survival decision trees. For more details on
the oblique RSF, see Jaeger et al, 2019.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">orsf</span><span class="op">(</span>
  <span class="va">data_train</span>,
  <span class="va">formula</span>,
  control <span class="op">=</span> <span class="fu"><a href="orsf_control_cph.html">orsf_control_cph</a></span><span class="op">(</span><span class="op">)</span>,
  n_tree <span class="op">=</span> <span class="fl">500</span>,
  n_split <span class="op">=</span> <span class="fl">5</span>,
  n_retry <span class="op">=</span> <span class="fl">0</span>,
  mtry <span class="op">=</span> <span class="cn">NULL</span>,
  leaf_min_events <span class="op">=</span> <span class="fl">1</span>,
  leaf_min_obs <span class="op">=</span> <span class="fl">5</span>,
  split_min_events <span class="op">=</span> <span class="fl">5</span>,
  split_min_obs <span class="op">=</span> <span class="fl">10</span>,
  oobag_pred <span class="op">=</span> <span class="cn">TRUE</span>,
  oobag_time <span class="op">=</span> <span class="cn">NULL</span>,
  oobag_eval_every <span class="op">=</span> <span class="va">n_tree</span>,
  importance <span class="op">=</span> <span class="cn">FALSE</span>,
  attach_data <span class="op">=</span> <span class="cn">TRUE</span>
<span class="op">)</span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>data_train</dt>
<dd><p>(<em>data.frame</em>) that will be used to grow the forest.</p></dd>
<dt>formula</dt>
<dd><p>(<em>formula</em>) a formula object, with the response on the left
of a <code>~</code> operator, and the terms on the right. See details.</p></dd>
<dt>control</dt>
<dd><p>An <code>aorsf_control</code> object, created with <a href="orsf_control_net.html">orsf_control_net</a>
or <a href="orsf_control_cph.html">orsf_control_cph</a>. Default is <code><a href="orsf_control_cph.html">orsf_control_cph()</a></code>.</p></dd>
<dt>n_tree</dt>
<dd><p>(<em>integer</em>) the number of trees to grow</p></dd>
<dt>n_split</dt>
<dd><p>(<em>integer</em>) the number of cut-points assessed when splitting
a node in decision trees.</p></dd>
<dt>n_retry</dt>
<dd><p>(<em>integer</em>) when a node can be split, but the current
linear combination of inputs is unable to provide a valid split, <code>orsf</code>
will try again with a new linear combination based on a different set
of randomly selected predictors, up to <code>n_retry</code> times. When
<code>n_retry = 0</code> (the default) the retry mechanic is not applied.</p></dd>
<dt>mtry</dt>
<dd><p>(<em>integer</em>) Number of variables randomly selected as candidates
for splitting a node. The default is the smallest integer greater than
the square root of the number of features. See details.</p></dd>
<dt>leaf_min_events</dt>
<dd><p>(<em>integer</em>) minimum number of events in a
leaf node.</p></dd>
<dt>leaf_min_obs</dt>
<dd><p>(<em>integer</em>) minimum number of observations in a
leaf node.</p></dd>
<dt>split_min_events</dt>
<dd><p>(<em>integer</em>) minimum number of events required
to split a node.</p></dd>
<dt>split_min_obs</dt>
<dd><p>(<em>integer</em>) minimum number of observations required
to split a node.</p></dd>
<dt>oobag_pred</dt>
<dd><p>(<em>logical</em>) if <code>TRUE</code> out-of-bag predictions are returned
in the <code>aorsf</code> object.</p></dd>
<dt>oobag_time</dt>
<dd><p>(<em>numeric</em>) A numeric value indicating what time
should be used for out-of-bag predictions.</p></dd>
<dt>oobag_eval_every</dt>
<dd><p>(<em>integer</em>) The out-of-bag performance of the
ensemble will be checked every <code>oobag_eval_every</code> trees. So, if
<code>oobag_eval_every = 10</code>, then out-of-bag performance is checked
after growing the 10th tree, the 20th tree, and so on.</p></dd>
<dt>importance</dt>
<dd><p>(<em>logical</em>) if <code>TRUE</code>, variable importance will be
computed using <em>negation</em> importance. With negation importance,
all coefficients for a given variable are multiplied by -1 and
then the out-of-bag error for the forest is re-computed. The greater
the degradation of the forest's error, the more important the variable.</p></dd>
<dt>attach_data</dt>
<dd><p>(<em>logical</em>) if <code>TRUE</code>, a copy of the training
data will be attached to the output. This is helpful if you
plan on using functions like <a href="orsf_pd_summary.html">orsf_pd_summary</a> to interpret the fitted
forest using its training data.</p></dd>
</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>an accelerated oblique RSF object (<code>aorsf</code>)</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>This function is based on and highly similar to the <code>ORSF</code> function
in the <code>obliqueRSF</code> R package. The primary difference is that this
function runs about 200 times faster because it uses a simplified
Newton Raphson scoring algorithm to identify linear combinations of
inputs rather than performing penalized regression using routines in
<code>glmnet</code>.The modified Newton Raphson scoring algorithm that this
function applies is an adaptation of the C++ routine developed by
Terry M. Therneau that fits Cox proportional hazards models
(see <code><a href="https://rdrr.io/pkg/survival/man/coxph.html" class="external-link">survival::coxph()</a></code>).</p>
<p><strong>What is an oblique decision tree?</strong></p>
<p>Decision trees are developed by splitting a set of training data into two
new subsets, with the goal of having more similarity within the new subsets
than between them. This splitting process is repeated on the resulting
subsets of data until a stopping criterion is met. When the new subsets of
data are formed based on a single predictor, the decision tree is said to
be axis-based because the splits of the data appear perpendicular to the
axis of the predictor. When linear combinations of variables are used
instead of a single variable, the tree is oblique because the splits of
the data are neither parallel nor at a right angle to the axis</p>
<p><em>Figure</em> : Decision trees for classification with axis-based splitting
(left) and oblique splitting (right). Cases are orange squares; controls
are purple circles. Both trees partition the predictor space defined by
variables X1 and X2, but the oblique splits do a better job of separating
the two classes.</p>
<p><img src="figures/tree_axis_v_oblique.png" width="95%"></p>
<p><strong>Some comments on inputs</strong></p>
<p><em>formula</em>: The response in <code>formula</code> can be a survival
object as returned by the <a href="https://rdrr.io/pkg/survival/man/Surv.html" class="external-link">survival::Surv</a> function,
but can also just be the time and status variables.
For example, <code>Surv(time, status) ~ .</code> works just like
<code>time + status ~ .</code>. The only thing that can break this
input is putting the variables in the wrong order, i.e.,
writing <code>status + time ~ .</code> will make <code>orsf</code> assume your
<code>status</code> variable is actually the <code>time</code> variable.</p>
<p><em>mtry</em>: The <code>mtry</code> parameter may be decreased while fitting an oblique
RSF. Currently oblique RSF's are fitted by a Newton Raphson scoring
algorithm that becomes unstable when the number of covariates is
greater than or equal to the number of events. During the ORSF
algorithm, mtry may be reduced temporarily to ensure there are at
least 2 events per predictor variable.</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Jaeger BC, Long DL, Long DM, Sims M, Szychowski JM, Min YI,
Mcclure LA, Howard G, Simon N. Oblique random survival forests.
<em>The Annals of Applied Statistics</em>. 2019 Sep;13(3):1847-83.
DOI: 10.1214/19-AOAS1261</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"></span>
<span class="r-in"><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu">orsf</span><span class="op">(</span><span class="va">pbc_orsf</span>, formula <span class="op">=</span> <span class="fu">Surv</span><span class="op">(</span><span class="va">time</span>, <span class="va">status</span><span class="op">)</span> <span class="op">~</span> <span class="va">.</span> <span class="op">-</span> <span class="va">id</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---------- Oblique random survival forest</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           N observations: 276</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                 N events: 111</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                  N trees: 500</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       N predictors total: 17</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    N predictors per node: 5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Average leaves per tree: 19</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Min observations in leaf: 5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       Min events in leaf: 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          OOB C-statistic: 0.84</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -----------------------------------------</span>
<span class="r-in"></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Byron Jaeger.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.1.</p>
</div>

      </footer></div>

  


  

  </body></html>

